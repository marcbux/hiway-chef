name: saasfeeDistributedEc2VariantcallScale2
ec2:
    type: m3.large
    ami: ami-234ecc54
    region: eu-west-1
    username: hiway
    price: 1

cookbooks:
  hadoop:
    github: "marcbux/apache-hadoop-chef"
    branch: "master"
  saasfee:
    github: "marcbux/hiway-chef"
    branch: "master"
    
attrs:
  saasfee:
    user: 'ubuntu'
    data: '/mnt/data'
    hiway:
      scheduler: 'greedyQueue'
      am:
        memory_mb: '6656'
        vcores: '2'
      worker:
        memory_mb: '6144'
        vcores: '2'
    variantcall:
      reads:
        url_base: 'http://s3.amazonaws.com/1000genomes/phase3/data'
      scale:
        nsamples: '1'
  hadoop:
    version: '2.7.1'
    yarn:
      vcores: '2'
      user: 'ubuntu'
      nm:
        memory_mbs: '6144'
    mr:
      user: 'ubuntu'
    tmp_dir: '/mnt/hadoop'
    data_dir: '/mnt/hadoop'
    num_replicas: '3'
  hdfs:
    user: 'ubuntu'
    
groups:
  nn:
    size: 1
    recipes:
        - hadoop::nn
        
  rm:
    size: 1
    recipes:
        - hadoop::rm
        - hadoop::jhs

  am:
    size: 1
    attrs:
      hadoop:
        yarn:
          nm:
            memory_mbs: '6656'
    recipes:
        - hadoop::nm
        - saasfee::hiway_client
        - saasfee::cuneiform_client
        - saasfee::variantcall_scale_client
        
  workers:
    size: 1
    recipes:
        - hadoop::dn
        - hadoop::nm
        - saasfee::hiway_worker
        - saasfee::variantcall_scale_worker
